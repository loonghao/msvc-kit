@echo off
REM Portable MSVC Toolchain Activation Script
REM Generated by msvc-kit
REM MSVC: {{ msvc_version }}, SDK: {{ sdk_version }}, Arch: {{ arch }}

setlocal enabledelayedexpansion

REM Get the directory where this script is located
set "BUNDLE_ROOT=%~dp0"
REM Remove trailing backslash
if "%BUNDLE_ROOT:~-1%"=="\" set "BUNDLE_ROOT=%BUNDLE_ROOT:~0,-1%"

REM VC paths
set "VCINSTALLDIR=%BUNDLE_ROOT%\VC"
set "VCToolsInstallDir=%BUNDLE_ROOT%\VC\Tools\MSVC\{{ msvc_version }}"
set "VCToolsVersion={{ msvc_version }}"

REM SDK paths
set "WindowsSdkDir=%BUNDLE_ROOT%\Windows Kits\10"
set "WindowsSDKVersion={{ sdk_version }}\"
set "WindowsSdkBinPath=%BUNDLE_ROOT%\Windows Kits\10\bin\{{ sdk_version }}"

REM INCLUDE paths
set "INCLUDE=%BUNDLE_ROOT%\VC\Tools\MSVC\{{ msvc_version }}\include"
set "INCLUDE=%INCLUDE%;%BUNDLE_ROOT%\Windows Kits\10\Include\{{ sdk_version }}\ucrt"
set "INCLUDE=%INCLUDE%;%BUNDLE_ROOT%\Windows Kits\10\Include\{{ sdk_version }}\shared"
set "INCLUDE=%INCLUDE%;%BUNDLE_ROOT%\Windows Kits\10\Include\{{ sdk_version }}\um"
set "INCLUDE=%INCLUDE%;%BUNDLE_ROOT%\Windows Kits\10\Include\{{ sdk_version }}\winrt"
set "INCLUDE=%INCLUDE%;%BUNDLE_ROOT%\Windows Kits\10\Include\{{ sdk_version }}\cppwinrt"

REM LIB paths
set "LIB=%BUNDLE_ROOT%\VC\Tools\MSVC\{{ msvc_version }}\lib\{{ arch }}"
set "LIB=%LIB%;%BUNDLE_ROOT%\Windows Kits\10\Lib\{{ sdk_version }}\ucrt\{{ arch }}"
set "LIB=%LIB%;%BUNDLE_ROOT%\Windows Kits\10\Lib\{{ sdk_version }}\um\{{ arch }}"

REM PATH additions
set "PATH=%BUNDLE_ROOT%\VC\Tools\MSVC\{{ msvc_version }}\bin\{{ host_arch }}\{{ target_arch }};%PATH%"
set "PATH=%BUNDLE_ROOT%\Windows Kits\10\bin\{{ sdk_version }}\{{ arch }};%PATH%"

REM Platform info
set "Platform={{ arch }}"
set "VSCMD_ARG_HOST_ARCH={{ arch }}"
set "VSCMD_ARG_TGT_ARCH={{ arch }}"

REM End local and export variables
endlocal & (
    set "VCINSTALLDIR=%VCINSTALLDIR%"
    set "VCToolsInstallDir=%VCToolsInstallDir%"
    set "VCToolsVersion=%VCToolsVersion%"
    set "WindowsSdkDir=%WindowsSdkDir%"
    set "WindowsSDKVersion=%WindowsSDKVersion%"
    set "WindowsSdkBinPath=%WindowsSdkBinPath%"
    set "INCLUDE=%INCLUDE%"
    set "LIB=%LIB%"
    set "PATH=%PATH%"
    set "Platform=%Platform%"
    set "VSCMD_ARG_HOST_ARCH=%VSCMD_ARG_HOST_ARCH%"
    set "VSCMD_ARG_TGT_ARCH=%VSCMD_ARG_TGT_ARCH%"
)

echo MSVC Toolchain activated (MSVC {{ msvc_version }}, SDK {{ sdk_version }}, {{ arch }})
